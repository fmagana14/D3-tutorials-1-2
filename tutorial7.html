<!DOCTYPE html>
<html>
  <head>
    <title>Using Paths</title>
  </head>
  <body>
    <svg id="svg" width="600" height="400"></svg>

    <script src="https://cdn.jsdelivr.net/npm/d3@7"></script>
    <style>
      /* Put the box in the center of the page */
      body,
      html {
        height: 100%;
        display: flex;
        justify-content: center;
        align-items: center;
      }

      #svg {
        border: 1px solid;
      }
    </style>
    <script>


      function handleData(data) {
        // draw stuff here
        const baData = getDataForState(data, "BA");
        // x scale
        const xscale = d3
          .scaleLinear()
          .domain([0, baData.length]) // number of values
          .range([40, 560]); // changed range
        // y-axis
        const percipitationExtents = d3.extent(baData, (d) => d.precipitation);
        const yscale = d3
          .scaleLinear()
          .domain(percipitationExtents)
          .range([40, 360]); //changed range

        // blue line generator
        const linegen = d3
          .line() // create a line generator
          .x((d, i) => xscale(i)) // map the x to the index
          .y((d) => yscale(d.precipitation)) // map y to percipitation
          .curve(d3.curveLinear); // apply a curve type

        d3.select("#svg")
          .append("path") // append a path
          .attr("d", linegen(baData)) // generate a line
          .attr("stroke-width", 5) //changed width 
          .attr("stroke", "cornflowerblue")
          .attr("fill", "none");
      }

      d3.csv("precipitation.csv").then(handleData);
      d3.csv("precipitation.csv").then(lineData);

      function lineData(data) {
        // draw stuff here
        const baData = getDataForState(data, "SE");
        // x scale
        const xscale = d3
          .scaleLinear()
          .domain([0, baData.length]) // number of values
          .range([40, 560]); // changed range
        // y-axis
        const percipitationExtents = d3.extent(baData, (d) => d.precipitation);
        const yscale = d3
          .scaleLinear()
          .domain(percipitationExtents)
          .range([40, 360]); //changed range

        // red line generator 
        const linegen = d3
          .line() // create a line generator
          .x((d, i) => xscale(i)) // map the x to the index
          .y((d) => yscale(d.precipitation)) // map y to percipitation
          .curve(d3.curveLinear); // apply a curve type

        d3.select("#svg")
          .append("path") // append a path
          .attr("d", linegen(baData)) // generate a line
          .attr("stroke-width", 2)
          .attr("stroke", "red")
          .attr("fill", "none");
      }

      function getDataForState(data, state) {
        const arr = data
          .filter((d) => d.state === state)
          .filter((d) => !isNaN(d.precipitation))
          .map((d) => {
            d.precipitation = parseFloat(d.precipitation);
            return d;
          });
        return arr;
      }
    </script>
  </body>
</html>
